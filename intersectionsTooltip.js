const t=new Intl.DateTimeFormat(navigator.language||"en",{weekday:"short",month:"short",day:"numeric"}),e=e=>{const{weekday:i,month:s,day:n}=t.formatToParts(e).reduce((t,{type:e,value:i})=>(t[e]=i,t),{});return`${i}, ${s} ${n}`};customElements.define("tg-intersection-point",class extends HTMLElement{constructor(){super();const t=document.getElementById("tg-intersection-point").content;this.attachShadow({mode:"open"}).appendChild(t.cloneNode(!0)),this._root=this.shadowRoot.getElementById("point"),this._valueEl=this.shadowRoot.getElementById("value"),this._labelEl=this.shadowRoot.getElementById("label"),this._state={value:"",label:"",color:"black"}}setState(t){"value"in t&&this._state.value!==t.value&&(this._state.value=t.value,this._valueEl.textContent=this._state.value),"label"in t&&this._state.label!==t.label&&(this._state.label=t.label,this._labelEl.textContent=this._state.label),"color"in t&&this._state.color!==t.color&&(this._state.color=t.color,this._root.style.color=this._state.color)}}),customElements.define("tg-intersections-tooltip",class extends HTMLElement{constructor(){super();const t=document.getElementById("tg-intersections-tooltip").content;this.attachShadow({mode:"open"}).appendChild(t.cloneNode(!0)),this._visible,this.setVisible(!1),this.hintEl=this.shadowRoot.getElementById("cursor-hint"),this._state={left:0,top:0,points:[]},this._pendingState,this._moment=null,this._pointElements=[],this._pointsContainer=this.shadowRoot.getElementById("points")}setState(t){t&&(this._pendingState={...this._pendingState,...t},this.scheduleUpdate())}scheduleUpdate(){this._pendingUpdate||(this._pendingUpdate=!0,window.requestAnimationFrame(()=>{this._pendingUpdate=!1,this.update()}))}renderPoints(t){this._pointElements=t.map(({value:t,label:e,labelColor:i})=>{const s=document.createElement("tg-intersection-point");return s.setState({value:t,label:e,labelColor:i}),s}),this._pointElements.forEach(t=>this._pointsContainer.appendChild(t))}update(){if(this._pendingState){if("left"in this._pendingState&&this._state.left!==this._pendingState.left&&(this._state.left=this._pendingState.left,this.hintEl.style.left=`${this._state.left}px`),"right"in this._pendingState&&this._state.right!==this._pendingState.right&&(this._state.right=this._pendingState.right,this.hintEl.style.right=`${this._state.right}px`),"timestamp"in this._pendingState&&this._state.timestamp!==this._pendingState.timestamp&&(this._state.timestamp=this._pendingState.timestamp,this._moment.innerText=e(this._state.timestamp)),"points"in this._pendingState&&this._state.points!==this._pendingState.points){if(0===this._state.points.length&&this.renderPoints(this._pendingState.points),this._state.points.length===this._pendingState.points.length&&this._pointElements.forEach((t,e)=>{t.setState(this._pendingState.points[e])}),this._state.points.length!==this._pendingState.points.length){const t=this._pointsContainer;for(;t.firstChild;)t.removeChild(t.firstChild);this.renderPoints(this._pendingState.points)}this._state.points=this._pendingState.points}this._pendingState=null}}setVisible(t){t===Boolean(t)&&t!==this._visible&&(this._visible=t,this.shadowRoot.getElementById("cursor-hint").classList[this._visible?"add":"remove"]("_visible"))}connectedCallback(){this.isConnected&&(this._moment=this.shadowRoot.getElementById("moment"))}});